
Техническое задание (ТЗ)
Проект: ADB Bug Bounty Hunter — интеллектуальный сканер логов Android Debug Bridge (ADB)
Цель: Создать инструмент и ИИ‑агент, способный автоматически искать в логах ADB любые реально значимые паттерны, коррелирующие с уязвимостями, утечками данных, диагностикой безопасности, системными ошибками, нарушениями политики безопасности и нестандартным поведением приложений.

==============================
1. Основная задача
==============================
Разработать систему анализа логов ADB, которая:
- Понимает контекст работы Android, системных сервисов, приложений.
- Учитывает реальные сценарии тестирования мобильных приложений в Bug Bounty.
- Автоматически классифицирует найденные события на истинные позитивы, ложные срабатывания и сомнительные.
- Использует продуманную коллекцию регулярных выражений, эвристик и паттернов поведения.
- Может быть улучшена ИИ‑агентом, который:
  (1) анализирует логи,
  (2) корректирует фильтры,
  (3) предлагается расширить обнаружение новых паттернов.

==============================
2. Контекст использования регулярных выражений
==============================
Регулярные выражения используются:
1. Для выделения событий ИБ в логах ADB.
2. Для фильтрации шумных строк.
3. Для категоризации типа события.
4. Для выявления нетривиальных паттернов (например, Data Leakage, IPC Abuse, insecure logs).
5. Для обнаружения вредоносных или опасных аномалий.

Система регулярок должна учитывать:
- особенности Android‑логирования
- типичные багбаунти кейсы
- ошибки разработчиков
- поведение вредоносных приложений
- утечки данных в логах
- нестандартное поведение Activity/Service/ContentProvider/BroadcastReceiver

==============================
3. Регулярки, которые необходимо расширить
==============================

3.1. Утечки данных / чувствительная информация:
- email / token / session / API key / Bearer / Authorization
- Google / Firebase / AWS / GCP credentials
- Coordinates / location / phone / imei / imsi / serial
- JWT tokens
- OAuth codes
- Internal URLs, localhost endpoints
- SQL queries leaking PII
- Debug-mode logs containing secrets
- Full exceptions leaking stacktraces with secrets

3.2. Нестандартное IPC-поведение:
- "binder" ошибки
- "permission denied" / "permission mismatch"
- вызовы к системным сервисам без разрешений
- попытки межпроцессного доступа
- взаимодействие с привилегированными сервисами (ActivityManagerService, PackageManagerService и др.)

3.3. Dangerous WebView events:
- webview error
- onReceivedSslError
- cleartext HTTP
- file:// usage
- javascript enabled warnings

3.4. Ошибки безопасности:
- "SecurityException"
- "SELinux"
- "AppOps"
- "keychain"
- "keystore"
- "crypto failure"

3.5. Аномальное поведение приложений:
- неожиданные интенты
- сервисы, стартующие сами по себе
- тайные broadcast‐ы
- попытки запуска скрытых activity
- excessive logging

3.6. Сетевая активность:
- cleartext
- proxy
- suspicious url
- MITM‑похожие ошибки
- неправильный SSL Pinning
- certificate exception

3.7. FileSystem:
- попытки чтения файлов за пределами sandbox
- запись приватных данных в world‑readable директории
- "open failed" с подозрительными путями

3.8. Инъекции:
- SQL
- JavaScript
- Command Injection trace patterns
- suspicious eval()

3.9. Разрешения:
- unexpected permission request
- revoked permissions usage
- app calling privileged permissions it shouldn’t use

3.10. Аномалии Android Framework:
- Activity/Window leaks
- ANR
- watchdog events
- memory corruption warnings
- native crash
- media server crash

==============================
4. Требования для ИИ‑агента
==============================
ИИ должен:
1. Предлагать новые паттерны на основе логов.
2. Классифицировать события:
   - HIGH: явное ИБ‑событие
   - MEDIUM: подозрительное
   - LOW: маловероятная проблема
   - NOISE: штатное поведение
3. Объяснять, почему сработало совпадение.
4. Давать рекомендации по расширению регулярок.
5. Обнаруживать новые категории событий самостоятельно.
6. Исключать заведомо ложные срабатывания (напр., com.android.* или package names mistaken as URLs).
7. Обучаться на реальных кейсах безопасности (Bug Bounty, Android malware analysis, Misconfigurations).
8. Работать как аналитик Mobile Security.

==============================
5. Источники реальных кейсов ИБ
==============================
ИИ должен учитывать реальные паттерны из:
- Google Bug Bounty (VRP)
- HackerOne, BugCrowd
- AOSP security bulletins
- Андроид малваре (xHelper, Stagefright, Triada и др.)
- OWASP MASVS/MSTG
- известные SDK‑утечки (Firebase, AdTech, аналитика)
- утечки логов популярных приложений

==============================
6. Результат разработки
==============================
Должны быть созданы:
1. База расширенных регулярных выражений (regex.db).
2. Python/PowerShell‑сканер с модульной архитектурой.
3. ИИ‑агент, способный анализировать логи и обновлять сигнатуры.
4. Автоматическая разметка логов.
5. Модуль исключений ложных срабатываний.
6. Категоризация событий.
7. Возможность подключения новых источников логов.

==============================
7. Дополнительные требования
==============================
- Поддержка огромных логов (до 2–10 ГБ).
- Работа в real‑time (если подключён через adb logcat).
- Отображение нового типа угрозы — ИИ фиксирует и предлагает добавить в базу.
- Расширяемость: каждый модуль должен быть самостоятельным.
- Поддержка verbose/filtered/summary просмотров.

